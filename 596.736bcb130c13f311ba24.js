"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[596],{596:(t,e,n)=>{n.a(t,(async(t,r)=>{try{n.r(e),n.d(e,{mkTxBalancer:()=>d});var a=n(7299),s=n(3741),o=n(598),u=n(8646),i=n(7340),c=n(6093),l=n(816).Buffer,p=t([a]);function d(t,e){return{balanceTx:function(n){return f(e,n).pipe((0,s.w)((function(e){return(0,c.U)("".concat(t.walletBackendUrl,"/v2/free/balance"),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json",Accept:"application/json"}})})),(0,s.w)((function(t){return t.json()})),(0,o.U)((function(t){var e=t.transaction;return a.YW8.from_bytes(l.from(e,"base64"))})))}}}function f(t,e){return(0,u.a)({changeAddress:t.changeAddress$,collateral:t.collateral$,inputs:t.utxos$}).pipe((0,s.w)((function(t){var n=t.changeAddress,r=t.collateral,a=t.inputs;return(0,i.of)({transaction:e.transaction,preset_inputs:e.inputs,redeemers:e.redeemers,payment_inputs:a.map(m),collateral_inputs:[m(r)],change_address:n.to_address().to_bech32()})})))}function m(t){return{id:l.from(t.input().transaction_id().to_bytes()).toString("hex"),index:t.input().index(),address:t.output().address().to_bech32(),amount:{quantity:Number(t.output().amount().coin().to_str()),unit:"lovelace"},assets:h(t)}}function h(t){var e=t.output().amount().multiasset();if(e){for(var n=[],r=0;r<e.keys().len();r+=1){var a=e.keys().get(r),s=e.get(a);if(s)for(var o=0;o<s.keys().len();o+=1){var u,i=s.keys().get(o),c={policy_id:l.from(a.to_bytes()).toString("hex"),asset_name:l.from(i.name()).toString("hex"),quantity:Number(null===(u=s.get(i))||void 0===u?void 0:u.to_str())};n.push(c)}}return n}return[]}a=(p.then?(await p)():p)[0],r()}catch(y){r(y)}}))}}]);